
CREATE TABLE PUBLIC.EXTRACT_METADATA_CONFIG (
    EXTRACT_ID UUID DEFAULT GEN_RANDOM_UUID() PRIMARY KEY,
	SEQUENCE_NUMBER INT4 NOT NULL,
	PIPELINE_ID UUID NOT NULL,
	DATAFRAME_NAME VARCHAR(255) NULL,
	SOURCE_CONFIGURATION TEXT NULL,
	PREDECESSOR_SEQUENCES VARCHAR(100) NULL,
	SUCCESSOR_SEQUENCES VARCHAR(100) NULL,
	DATA_SOURCE_CONNECTION_ID UUID NULL,
	CREATED_TIMESTAMP TIMESTAMP DEFAULT CURRENT_TIMESTAMP NULL,
	CREATED_BY VARCHAR(255) DEFAULT CURRENT_USER NULL,
	UPDATED_TIMESTAMP TIMESTAMP NULL,
	UPDATED_BY VARCHAR(255) NULL,
	ACTIVE_FLAG VARCHAR(1) DEFAULT 'Y'::CHARACTER VARYING NULL,
	CONSTRAINT PK_EXTRACT_METADATA_CONFIG UNIQUE (PIPELINE_ID, SEQUENCE_NUMBER)
);

-- Permissions

ALTER TABLE public.extract_metadata_config OWNER TO postgres;
GRANT ALL ON TABLE public.extract_metadata_config TO postgres;


-- public.extract_metadata_config foreign keys

ALTER TABLE public.extract_metadata_config ADD CONSTRAINT fk_data_source_connection FOREIGN KEY (DATA_SOURCE_CONNECTION_ID) REFERENCES public.data_sources_connections(CONNECTION_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE public.extract_metadata_config ADD CONSTRAINT fk_data_source_type FOREIGN KEY (DATA_SOURCE_CONNECTION_ID) REFERENCES public.data_sources_types(data_source_id) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE public.extract_metadata_config ADD CONSTRAINT fk_pipeline_id FOREIGN KEY (PIPELINE_ID) REFERENCES public.data_pipelines(PIPELINE_ID) ON DELETE CASCADE ON UPDATE CASCADE;